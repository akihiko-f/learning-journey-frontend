# Day 6 - 2025/10/21

## 学んだこと

### 1. コンポーネント分割
- 大きなコンポーネントを小さく分割
- 関心の分離（Separation of Concerns）
- 再利用可能なコンポーネント設計

### 2. Props（プロップス）
- 親コンポーネントから子コンポーネントへデータを渡す
- 関数もPropsとして渡せる
- `{ プロップ名 }` で受け取る（分割代入）

### 3. import/export
- `export default` でコンポーネントをエクスポート
- `import` で他のファイルからインポート
- 相対パスでファイルを指定

### 4. コンポーネント設計
- 単一責任の原則（1つのコンポーネントは1つの役割）
- 親コンポーネントがロジック、子コンポーネントが表示
- Props経由でデータと関数を渡す

## 実装した内容
- App.jsxを4つのコンポーネントに分割
  - TodoForm（入力フォーム）
  - FilterTabs（フィルタータブ）
  - TodoList（リスト表示）
  - TodoItem（個別アイテム）

## 学習メモ

### コンポーネント分割前

```jsx
// App.jsx (132行)
function App() {
  // state管理
  // 関数定義
  // JSX（全ての表示）
}
```

**問題点:**
- コードが長くて読みにくい
- 修正箇所を見つけにくい
- 再利用できない

### コンポーネント分割後

```
App.jsx (116行) - 親コンポーネント
  ├── TodoForm.jsx (18行)
  ├── FilterTabs.jsx (28行)
  ├── TodoList.jsx (26行)
  └── TodoItem.jsx (59行)
```

**メリット:**
- 各ファイルが短くて読みやすい
- 役割が明確
- 再利用できる
- テストしやすい

## Props（プロップス）とは

### 基本概念

**Props = 親コンポーネントから子コンポーネントへ渡すデータ**

```jsx
// 親コンポーネント
<TodoForm inputValue={inputValue} />
          ↓ Propsで渡す

// 子コンポーネント
function TodoForm({ inputValue }) {
  // inputValueを使える
}
```

### Propsの渡し方

```jsx
// App.jsx（親）
<TodoForm
  inputValue={inputValue}      // 値を渡す
  setInputValue={setInputValue} // 関数を渡す
  addTodo={addTodo}            // 関数を渡す
/>
```

### Propsの受け取り方

```jsx
// TodoForm.jsx（子）
function TodoForm({ inputValue, setInputValue, addTodo }) {
  //               ↑ 分割代入で受け取る
  return (
    <input value={inputValue} onChange={...} />
  )
}
```

**分割代入 = オブジェクトからプロパティを取り出す**

```jsx
// 通常の書き方
function TodoForm(props) {
  const inputValue = props.inputValue
  const addTodo = props.addTodo
}

// 分割代入（簡潔）
function TodoForm({ inputValue, addTodo }) {
  // 直接使える
}
```

## 各コンポーネントの役割

### 1. App.jsx（親コンポーネント）

**役割:** ロジックとstate管理

- 全てのstateを管理
- 全ての関数を定義
- 子コンポーネントにPropsで渡す

```jsx
<TodoForm
  inputValue={inputValue}
  setInputValue={setInputValue}
  addTodo={addTodo}
/>
```

### 2. TodoForm.jsx

**役割:** 入力フォームの表示

**受け取るProps:**
- `inputValue`: 入力欄の値
- `setInputValue`: 入力値を更新する関数
- `addTodo`: 追加ボタンの処理

```jsx
function TodoForm({ inputValue, setInputValue, addTodo }) {
  return (
    <>
      <input value={inputValue} onChange={(e) => setInputValue(e.target.value)} />
      <button onClick={addTodo}>追加</button>
    </>
  )
}
```

### 3. FilterTabs.jsx

**役割:** フィルタータブの表示

**受け取るProps:**
- `filter`: 現在のフィルター状態
- `setFilter`: フィルターを変更する関数

```jsx
function FilterTabs({ filter, setFilter }) {
  return (
    <div className="filter-tabs">
      <button onClick={() => setFilter("all")}>全て</button>
      <button onClick={() => setFilter("active")}>未完了</button>
      <button onClick={() => setFilter("completed")}>完了</button>
    </div>
  )
}
```

### 4. TodoList.jsx

**役割:** ToDoリスト全体の表示

**受け取るProps:**
- `filteredTodos`: フィルタリング済みのToDo配列
- その他、TodoItemに渡すための関数

```jsx
function TodoList({ filteredTodos, ...otherProps }) {
  return (
    <ul>
      {filteredTodos.map((todo) => (
        <TodoItem key={todo.id} todo={todo} {...otherProps} />
      ))}
    </ul>
  )
}
```

### 5. TodoItem.jsx

**役割:** 個別ToDoの表示

**受け取るProps:**
- `todo`: ToDoオブジェクト
- `editingId`, `editingText`: 編集状態
- `toggleTodo`, `startEdit`, `saveEdit`, `cancelEdit`, `deleteTodo`: 操作関数

```jsx
function TodoItem({ todo, editingId, toggleTodo, ... }) {
  return (
    <li>
      <input type="checkbox" onChange={() => toggleTodo(todo.id)} />
      <span>{todo.text}</span>
      <button onClick={() => deleteTodo(todo.id)}>削除</button>
    </li>
  )
}
```

## データの流れ

### Props の流れ（親 → 子）

```
App（親）
  ↓ Props
TodoList（子）
  ↓ Props
TodoItem（孫）
```

**一方向データフロー:**
- データは親から子へ一方向に流れる
- 子は受け取ったPropsを直接変更できない
- 子がデータを変更したい時は、親から渡された関数を呼ぶ

### 例: チェックボックスをクリックした時

```
1. ユーザーがチェックボックスをクリック（TodoItem）
   ↓
2. toggleTodo(todo.id) を呼ぶ
   ↓
3. Appのtoggle関数が実行される
   ↓
4. Appのtodosが更新される
   ↓
5. 再レンダリング
   ↓
6. 新しいPropsが子コンポーネントに渡る
   ↓
7. 画面が更新される
```

## import/export の仕組み

### export（エクスポート）

```jsx
// TodoForm.jsx
function TodoForm({ inputValue }) {
  return <input value={inputValue} />
}

export default TodoForm  // このコンポーネントをエクスポート
```

**`export default`** = このファイルのメインのものをエクスポート

### import（インポート）

```jsx
// App.jsx
import TodoForm from './components/TodoForm'
//     ↑ 名前         ↑ ファイルパス
```

**相対パス:**
- `./` = 同じディレクトリ
- `../` = 1つ上のディレクトリ
- `.jsx` は省略可能

## コンポーネント設計の原則

### 1. 単一責任の原則

**1つのコンポーネントは1つの役割だけ**

```jsx
// ✅ 良い例
TodoForm → 入力フォームだけ
TodoItem → 1つのToDoだけ

// ❌ 悪い例
App → 全部やる（分割前）
```

### 2. 親がロジック、子が表示

**親コンポーネント:**
- state管理
- 関数定義
- ロジック

**子コンポーネント:**
- Propsを受け取る
- 表示（JSX）
- 見た目

### 3. Propsは読み取り専用

```jsx
// ❌ ダメ: Propsを直接変更
function TodoForm({ inputValue }) {
  inputValue = "新しい値"  // エラー！
}

// ✅ 良い: 親から渡された関数を呼ぶ
function TodoForm({ inputValue, setInputValue }) {
  setInputValue("新しい値")  // OK
}
```

## トラブルシューティング

### 発生したエラー

**TodoItem.jsx:17 Uncaught ReferenceError: toggleTodo is not defined**

**原因:**
- `toggleTodo`をPropsで受け取っていなかった
- 関数パラメータに`toggleTodo`が抜けていた

**修正:**
```jsx
// 修正前
function TodoItem({
  todo,
  editingId,
  // toggleTodo が抜けていた
  ...
})

// 修正後
function TodoItem({
  todo,
  editingId,
  toggleTodo,  // 追加
  ...
})
```

### 学んだこと
- Propsで渡したものは、子コンポーネントで必ず受け取る必要がある
- Propsの名前は正確に（親と子で一致させる）

## 理解した概念

### Props vs State

| 項目 | Props | State |
|------|-------|-------|
| 定義 | 親から渡される | コンポーネント内で管理 |
| 変更 | 読み取り専用 | setterで変更可能 |
| 用途 | データの受け渡し | コンポーネントの状態 |

### コンポーネントツリー

```
App
├── TodoForm
├── FilterTabs
└── TodoList
    └── TodoItem (複数)
```

**親子関係:**
- App → TodoForm, FilterTabs, TodoListの親
- TodoList → TodoItemの親

### 分割代入

```jsx
// オブジェクト
const user = { name: "Akihiko", age: 25 }
const { name, age } = user
// name = "Akihiko", age = 25

// Props
function TodoForm({ inputValue, addTodo }) {
  // inputValue と addTodo を直接使える
}
```

## 新しく学んだ用語

- **Props（プロップス）**: 親から子へ渡すデータ
- **export/import**: ファイル間でコードを共有する仕組み
- **コンポーネントツリー**: コンポーネントの親子関係
- **単一責任の原則**: 1つのコンポーネントは1つの役割
- **一方向データフロー**: データは親から子へ一方向に流れる
- **分割代入**: オブジェクトからプロパティを取り出す構文

## コード量の比較

### 分割前
- App.jsx: 132行

### 分割後
- App.jsx: 116行
- TodoForm.jsx: 18行
- FilterTabs.jsx: 28行
- TodoList.jsx: 26行
- TodoItem.jsx: 59行
- **合計: 247行**

**行数は増えたが:**
- 各ファイルが短く読みやすい
- 役割が明確
- 再利用可能
- メンテナンスしやすい

## まとめ

### Phase 1 完了！

- ✅ 1. チェックボックス
- ✅ 2. 編集機能
- ✅ 3. LocalStorage
- ✅ 4. フィルター機能
- ✅ 5. コンポーネント分割

**Phase 1（写経フェーズ）を全て完了しました！**

### 学んだ主要概念

1. **React基礎**: useState, useEffect
2. **配列操作**: map, filter
3. **条件分岐**: 三項演算子、if文
4. **データ永続化**: LocalStorage, JSON
5. **コンポーネント設計**: Props, 分割

### 次のステップ

**Phase 2: お題から実装（実践フェーズ）**
- ヒントなしで自分で実装
- エラーを自分で解決
- 学んだ知識を統合
