# Day 4 - 2025/11/04

## 学んだこと

### 1. 配列のstate管理
- `useState`で配列を管理する方法を学習
- 計算履歴を配列として保存（`history` state）
- スプレッド構文（`...`）を使った配列への新しい要素の追加
- `[...history, newItem]`の形式で、既存の配列を変更せず新しい配列を作成

### 2. イミュータブル（不変）な更新の概念
- Reactでは既存のstateを直接変更してはいけない
- 配列や オブジェクトは常に新しいコピーを作成して更新
- `array.push()`ではなく`[...array, newItem]`を使う理由
- イミュータブルな更新によりReactが変更を正しく検知できる

### 3. 条件付きレンダリング
- 三項演算子（`condition ? trueの場合 : falseの場合`）を使った表示の切り替え
- `history.length === 0`で履歴が空かどうかを判定
- 履歴がない場合とある場合で異なるUIを表示

### 4. テンプレートリテラル
- バッククォート（`` ` ``）を使った文字列の生成
- `${変数}`で変数を文字列の中に埋め込む
- 計算式の表示に活用（例: `` `${num1} ${operator} ${num2} = ${result}` ``）

### 5. mapメソッドによるリスト表示
- 配列の各要素をJSXに変換する`map`メソッド
- `history.map((item, index) => <div key={index}>...</div>)`の形式
- `key`プロパティの重要性（Reactが各要素を識別するため）

## 実装した内容
- 計算履歴機能の追加
  - 履歴を保存する`history` stateの作成
  - 計算実行時に履歴への追加処理を実装
  - 履歴の表示UIを作成
- 履歴表示の機能
  - 計算式（`num1 operator num2 = result`）の形式で表示
  - 履歴がない場合は「まだ計算履歴がありません」と表示
- CSSスタイリング
  - 履歴セクション（`.history-section`）のスタイル
  - 履歴タイトル（`.history-title`）のスタイル
  - 個別の履歴アイテム（`.history-item`）のスタイル
  - 履歴がない場合のメッセージスタイル

## 学習メモ

### コード例：配列のイミュータブルな更新

```jsx
// ❌ 悪い例：既存の配列を直接変更
history.push(newItem);
setHistory(history);

// ✅ 良い例：新しい配列を作成
setHistory([...history, newItem]);
```

### コード例：計算履歴の保存

```jsx
const [history, setHistory] = useState([]);

const calculate = () => {
  // 計算処理
  const calculatedResult = num1 + num2; // 例
  setResult(calculatedResult);

  // 履歴に追加
  setHistory([
    ...history,
    {
      num1: num1,
      num2: num2,
      operator: operator,
      result: calculatedResult
    }
  ]);
};
```

### コード例：条件付きレンダリングとmap

```jsx
<div className="history-section">
  <h3>計算履歴</h3>
  {history.length === 0 ? (
    <p className="empty-message">まだ計算履歴がありません</p>
  ) : (
    <div className="history-list">
      {history.map((item, index) => (
        <div key={index} className="history-item">
          {`${item.num1} ${item.operator} ${item.num2} = ${item.result}`}
        </div>
      ))}
    </div>
  )}
</div>
```

### 重要なポイント

1. **スプレッド構文の使い方**
   - `...`は配列やオブジェクトの要素を「展開」する
   - `[...oldArray, newItem]`で古い配列のすべての要素と新しい要素を含む新配列を作成

2. **keyプロパティ**
   - `map`でリストを生成する際は必ず`key`を指定
   - 各要素を一意に識別するために使用
   - 今回は`index`を使用したが、実際のアプリでは一意なIDを使う方が良い

3. **三項演算子の読み方**
   - `条件 ? 真の場合 : 偽の場合`
   - if-else文を1行で書ける便利な構文
   - JSXの中で条件分岐する際によく使用

## その他の作業
- Gitコミット：「計算履歴を追加」
- CSSファイルに34行、JSXファイルに18行を追加
- 計算機アプリの基本機能が完成
